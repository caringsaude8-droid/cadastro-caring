<app-page-header title="Relatórios de Cadastro" subtitle="Inclusões realizadas via formulário"></app-page-header>

<div class="relatorios-container">
  <div class="stats-section">
    <div class="stats-grid">
      <div class="stat-card caring-card stat-total">
        <div class="stat-icon"><i class="icon-users"></i></div>
        <div class="stat-content">
          <h3 class="stat-title">Total de Registros</h3>
          <p class="stat-value">{{stats.total}}</p>
        </div>
      </div>
      <div class="stat-card caring-card stat-active">
        <div class="stat-icon"><i class="icon-check-circle"></i></div>
        <div class="stat-content">
          <h3 class="stat-title">Com Inclusão</h3>
          <p class="stat-value">{{stats.inclusoes}}</p>
        </div>
      </div>
      <div class="stat-card caring-card stat-inactive">
        <div class="stat-icon"><i class="icon-x-circle"></i></div>
        <div class="stat-content">
          <h3 class="stat-title">Com Exclusão</h3>
          <p class="stat-value">{{stats.exclusoes}}</p>
        </div>
      </div>
    </div>
  </div>

  <div class="filters-section">
    <div class="filters-container caring-card">
      <div class="search-group">
        <i class="icon-search"></i>
        <input type="text" class="input" [(ngModel)]="filtroTermo" (input)="onSearch()" placeholder="Filtrar por nome, CPF, matrícula ou empresa" />
      </div>
      <select class="filter-select" [(ngModel)]="selectedRelacaoDep" (change)="onRelacaoChange()">
        <option value="">Todas as Relações</option>
        <option value="titular">Titular</option>
        <option value="dependente">Dependente</option>
      </select>
      <select class="filter-select" [(ngModel)]="selectedPlanoProd" (change)="onPlanoChange()">
        <option value="">Todos os Planos</option>
        <option *ngFor="let p of planosDisponiveis" [value]="p">{{p}}</option>
      </select>
      <button class="btn btn-secondary" (click)="clearFilters()"><i class="icon-refresh"></i> Limpar Filtros</button>
      <button class="btn btn-primary" (click)="downloadExcel()"><i class="icon-download"></i> Exportar Excel</button>
    </div>
  </div>

  <div class="table-wrapper">
    <table class="table">
      <thead>
        <tr>
          <th>Nome Segurado</th>
          <th>CPF</th>
          <th>Relação Dep.</th>
          <th>Plano/Prod</th>
          <th>Data Inclusão</th>
          <th>Data Exclusão</th>
          <th>Código Empresa</th>
          <th>Número Empresa</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let r of filtered">
          <td>{{ r.nomeSegurado }}</td>
          <td>{{ r.cpf }}</td>
          <td>{{ r.relacaoDep }}</td>
          <td>{{ r.planoProd }}</td>
          <td>{{ r.dataInclusao }}</td>
          <td>{{ r.dataExclusao }}</td>
          <td>{{ r.codigoEmpresa }}</td>
          <td>{{ r.numeroEmpresa }}</td>
        </tr>
        <tr *ngIf="filtered.length === 0">
          <td colspan="7" class="empty">Nenhuma inclusão encontrada via formulário.</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
